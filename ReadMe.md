ChatGPT(OpenAI API)èˆ‡å°è«‡æ©Ÿå™¨äººé–‹ç™¼å¯¦æˆ°(2 day) - UUU - 2023/10/4, 5
doc url: https://wwjd.tw/608k615

æŒ‘æˆ°è³½: (Google sheet)
https://docs.google.com/spreadsheets/d/1L7bQX55mKutJFrOp9aE0gkItowMlCmtJyaNlogzrUsc/edit?usp=sharing

è²¼ä¸Šåœ–ç‰‡æ›URL:
https://hackmd.io/usaHN0xhR5ur2MxBXCobFw?both

ä¸Šå‚³åœ–ç‰‡å–å¾—ç¶²å€:
http://imgur.com or https://zh-tw.imgbb.com/ or https://upload.cc/

ğŸ“šå­¸å“¡ä¸Šèª²ç’°å¢ƒï¼š
å»ºè­°ä½¿ç”¨ Windows 10/11(ä¸­æ–‡ç‰ˆ)
å»ºè­°ä½¿ç”¨ Edge ç€è¦½å™¨
Postman
https://www.getpostman.com/downloads/
Visual Studio Code
https://code.visualstudio.com/
.net core SDK 5.0+
https://dotnet.microsoft.com/download
Visual Studio community (optional, windows only)
https://visualstudio.microsoft.com/zh-hant/vs/community/
ğŸ“¡ç¶²è·¯èˆ‡ç¡¬é«”ç’°å¢ƒéœ€æ±‚
ç”±æ–¼å¤§é‡å¯¦ä½œå‡éœ€è¦é€£ä¸Šé›²ç«¯ï¼Œå»ºè­°ç¶²è·¯é€Ÿåº¦ä¸ä½æ–¼100Mçš„ä¸Šèª²ç’°å¢ƒè¼ƒä½³
ç¶²è·¯éœ€è¦å¯ä»¥é€£ç·šä¸Šç¶²(80, 443)ï¼Œè«‹å‹¿é˜»æ“‹ 3389, 1433ç­‰port.
â›³èª²å‰é å‚™èˆ‡å¸³è™Ÿç”³è«‹
ç”³è«‹å€‹äºº Microsoft Account å¸³è™Ÿ(è‹¥æ‚¨å·²æœ‰ä¸€èˆ¬ hotmail.com æˆ– outlook.com ä¿¡ç®±ï¼Œè©²ä¿¡ç®±å³æ˜¯ Microsoft Account)ï¼Œä¸å»ºè­°æ¡ç”¨å…¬å¸å¸³è™Ÿ
è‹¥æ‚¨ä¸ç¢ºå®šæ˜¯å¦å·²æ“æœ‰ Microsoft Accountï¼Œå¯æ–¼åº•ä¸‹ç¶²å€ç”³è«‹ä¸€å€‹å…¨æ–°çš„:
https://account.microsoft.com/account?lang=zh-tw

è«‹ç”¨å‰›æ‰ç”³è«‹çš„ã€å€‹äºº Microsoft Accountã€å¸³è™Ÿç”³è«‹å…è²» Azure è¨‚é–±(subscription) ä»¥ä¾¿æ–¼é€²å…¥Azure Portal (éœ€ç¶ä¿¡ç”¨å¡ï¼Œä½†ç„¡é ˆä»˜è²»)
(è«‹å‹™å¿…æ–¼ä¸Šèª²å‰ç”³è«‹ï¼Œä¸Šèª²ä¸­ç”³è«‹å¤±æ•—ç‡éå¸¸é«˜ï¼ŒåŒä¸€å€‹å°å¤–IPçŸ­æ™‚é–“å…§ç„¡æ³•å¤šæ¬¡ç”³è«‹)
https://azure.microsoft.com/zh-tw/free/
ğŸ”¥ğŸ”¥ğŸ”¥(é‡è¦) å»ºç«‹å¥½ Azure è¨‚é–±(subscription)ä¹‹å¾Œï¼Œå¡«å¯«ä¸‹åˆ—è¡¨æ ¼ç”³è«‹ Azure Open AIæœå‹™(å»ºè­°æ–¼ä¸Šèª²å‰15å¤©å®Œæˆ)
https://aka.ms/oai/access
ğŸ”¥ğŸ”¥ğŸ”¥(é‡è¦) å»ºç«‹å¥½ Azure è¨‚é–±(subscription)ä¹‹å¾Œï¼Œå¡«å¯«ä¸‹åˆ—è¡¨æ ¼ç”³è«‹ Azure Cognitive Servicesæœå‹™(å»ºè­°æ–¼ä¸Šèª²å‰15å¤©å®Œæˆ)
https://learn.microsoft.com/zh-tw/azure/cognitive-services/cognitive-services-limited-access
é–‹ç™¼å·¥å…·
VS Code:
https://code.visualstudio.com/

VS 2019/2022 community(good enough):
https://visualstudio.microsoft.com/zh-hant/downloads/

Postman:
https://www.postman.com/
https://www.postman.com/downloads/

ç›¸é—œSDKèˆ‡å·¥å…·(å…ˆå®‰è£VS2019/2022):
Bot Framework v4 SDK Templates for Visual Studio:
https://marketplace.visualstudio.com/items?itemName=BotBuilder.botbuilderv4

BotFramework-Emulator:
https://github.com/microsoft/BotFramework-Emulator/releases/download/v4.11.0/BotFramework-Emulator-4.11.0-windows-setup.exe

ChatGPT
ğŸ‘‰å–å¾— OpenAI API key(éœ€ä¿¡ç”¨å¡ã€æœƒæœ‰å°é¡è²»ç”¨):
https://platform.openai.com/account/api-keys

ğŸ‘‰Sample OpenAI API Key:
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

Lab 1 : ä½¿ç”¨ postman å‘¼å« OpenAI completion API


æ­¥é©Ÿ:

æŸ¥è©¢æ–‡ä»¶, æ‰¾åˆ°completion API
https://platform.openai.com/docs/api-reference/completions
ä½¿ç”¨ postman å‘¼å«API
endpoint : https://api.openai.com/v1/completions
Authorization: Bearer OPENAI_API_KEY
è¼¸å…¥API key, çµ„å‡ºrequest
{
  "model": "text-davinci-003",
  "prompt": "ä»€éº¼æ˜¯äººå·¥æ™ºæ…§? é€™æ˜¯",
  "max_tokens": 1000,
  "temperature": 0.8
}
å–å¾—response, æª¢è¦–çµæœ <== æˆªåœ–
Lab 2 : ä½¿ç”¨ postman å‘¼å« image generations API
æ­¥é©Ÿ:

æŸ¥è©¢æ–‡ä»¶, æ‰¾åˆ°image generations API
https://platform.openai.com/docs/api-reference/images/create
ä½¿ç”¨postman, çµ„å‡ºrequest, è¼¸å…¥API key
POST /v1/images/generations HTTP/1.1
Host: api.openai.com
Authorization: Bearer [replace key]
Content-Type: application/json
Content-Length: 65

{
  "prompt": "å¤•é™½ä¸‹å­¤ç¨çš„èº«å½±" , 
  "n": 1,
  "size": "1024x1024"
}
å–å¾—response, æª¢è¦–çµæœ
Lab 3 : ä½¿ç”¨ OpenAI API å‘¼å«ChatGPTé€²è¡Œå°è«‡
POST /v1/chat/completions HTTP/1.1
Host: api.openai.com
Authorization: Bearer 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
Content-Type: application/json
Content-Length: 138

{
  "model": "gpt-3.5-turbo",
  "max_tokens" : 300, 
  "temperature" : 0.1, 
  "messages": [{"role": "user", "content": "æˆ‘ä»Šå¤©å¿ƒæƒ…å¾ˆå¥½"}]
}
LINE BOT
å»ºç«‹ line bot
https://developers.line.biz/en/

NGROK:
ğŸ‘‰ç”³è«‹å¸³è™Ÿ:
https://dashboard.ngrok.com/signup
ğŸ‘‰download ngrok:
https://ngrok.com/download
or
https://bin.equinox.io/c/bNyj1mQVY4c/ngrok-v3-stable-windows-amd64.zip

Lab 4: create a ChatGPT bot
create a line bot (messaging api)
https://developers.line.biz/en/
get Channel access token and Your UserID
create a new webapi project
md testbot
cd testbot
dotnet new webapi
dotnet new --install isRock.Template.LineWebHook::1.0.17 
# https://arock.blob.core.windows.net/blogdata202310/LineBotChatGPTWebHookController.cs
dotnet add package linebotsdk
dotnet new linewebhook
code .
#ç·¨è¼¯ç¨‹å¼ç¢¼
dotnet run    
final version:
git clone https://github.com/isdaviddong/test20231002bot.git

run ngrok command:

ngrok authtoken 2eeb482nM____your____token____V3Ar4
ngrok http 5000 --host-header="localhost:5000" 
sample code:
https://gist.github.com/isdaviddong/5c630c9a97720962fc52ef766dbb7530#file-openailinebot-cs

//åŸºæœ¬çš„ OpenAI ChatGPT WebHook
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net.Http.Headers;
using System.Text;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.Logging;
using Newtonsoft.Json;
using System.Net.Http;

namespace isRock.Template
{
    public class LineBotChatGPTWebHookController : isRock.LineBot.LineWebHookControllerBase
    {
        [Route("api/LineBotChatGPTWebHook")]
        [HttpPost]
        public IActionResult POST()
        {
            const string AdminUserId = "_____Admin_User_ID_________"; //ğŸ‘‰repleace it with your Admin User Id

            try
            {
                //è¨­å®šChannelAccessToken
                this.ChannelAccessToken = "____LINE_Channel_Access_Token____"; //ğŸ‘‰repleace it with your Channel Access Token
                //é…åˆLine Verify
                if (ReceivedMessage.events == null || ReceivedMessage.events.Count() <= 0 ||
                    ReceivedMessage.events.FirstOrDefault().replyToken == "00000000000000000000000000000000") return Ok();
                //å–å¾—Line Event
                var LineEvent = this.ReceivedMessage.events.FirstOrDefault();
                var responseMsg = "";
                //æº–å‚™å›è¦†è¨Šæ¯
                if (LineEvent.type.ToLower() == "message" && LineEvent.message.type == "text")
                {
                    responseMsg = ChatGPT.getResponseFromGPT(LineEvent.message.text);
                }
                else if (LineEvent.type.ToLower() == "message")
                    responseMsg = $"æ”¶åˆ° event : {LineEvent.type} type: {LineEvent.message.type} ";
                else
                    responseMsg = $"æ”¶åˆ° event : {LineEvent.type} ";
                //å›è¦†è¨Šæ¯
                this.ReplyMessage(LineEvent.replyToken, responseMsg);
                //response OK
                return Ok();
            }
            catch (Exception ex)
            {
                //å›è¦†è¨Šæ¯
                this.PushMessage(AdminUserId, "ç™¼ç”ŸéŒ¯èª¤:\n" + ex.Message);
                //response OK
                return Ok();
            }
        }
    }

    public class ChatGPT
    {
        [JsonConverter(typeof(Newtonsoft.Json.Converters.StringEnumConverter))]
        public enum role
        {
            assistant, user, system
        }

        public static string CallOpenAIChatAPI(object requestData)
        {
            var client = new HttpClient();

            // è¨­å®š API ç¶²å€
            var apiUrl = $"https://api.openai.com/v1/chat/completions";

            // è¨­å®š HTTP request headers
            client.DefaultRequestHeaders.Add("Authorization", "Bearer sk-sEoH______open_ai_api_key_____qQTZU");
            client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue("application/json"));//ACCEPT heade
            // å°‡ requestData ç‰©ä»¶åºåˆ—åŒ–æˆ JSON å­—ä¸²
            string jsonRequestData = Newtonsoft.Json.JsonConvert.SerializeObject(requestData);
            // å»ºç«‹ HTTP request å…§å®¹
            var content = new StringContent(jsonRequestData, Encoding.UTF8, "application/json");
            // å‚³é€ HTTP POST request
            var response = client.PostAsync(apiUrl, content).Result;
            // å–å¾— HTTP response å…§å®¹
            var responseContent = response.Content.ReadAsStringAsync().Result;
            var obj = Newtonsoft.Json.JsonConvert.DeserializeObject<dynamic>(responseContent);
            return obj.choices[0].message.content.Value;
        }


        public static string getResponseFromGPT(string Message)
        {
            return ChatGPT.CallOpenAIChatAPI(
                new
                {
                    model = "gpt-3.5-turbo",
                    messages = new[]
                    {
                        new {
                            role = ChatGPT.role.system ,
                            content = @"
                                å‡è¨­ä½ æ˜¯ä¸€å€‹å°ˆæ¥­å®¢æˆ¶æœå‹™äººå“¡ï¼Œå°æ–¼å®¢æˆ¶éå¸¸æœ‰ç¦®è²Œã€ä¹Ÿèƒ½å¤ å®‰æ’«å®¢æˆ¶çš„æŠ±æ€¨æƒ…ç·’ã€‚
                                è«‹æª¢è¦–åº•ä¸‹çš„å®¢æˆ¶è¨Šæ¯ï¼Œä»¥æœ€è¦ªåˆ‡æœ‰ç¦®çš„æ–¹å¼å›æ‡‰ã€‚

                                ä½†å›æ‡‰æ™‚ï¼Œè«‹æ³¨æ„ä»¥ä¸‹å¹¾é»:
                                * ä¸è¦èªª 'æ„Ÿè¬ä½ çš„ä¾†ä¿¡' ä¹‹é¡çš„è©±ï¼Œå› ç‚ºå®¢æˆ¶æ˜¯å¾å°è«‡è¦–çª—è¼¸å…¥è¨Šæ¯çš„ï¼Œä¸æ˜¯å¯«ä¿¡ä¾†çš„
                                * ä¸èƒ½éåº¦æ‰¿è«¾
                                * è¦åŒç†å®¢æˆ¶çš„æƒ…ç·’
                                * è¦èƒ½å¤ ç›¡é‡è§£æ±ºå®¢æˆ¶çš„å•é¡Œ
                                * ä¸è¦ä»¥å›è¦†ä¿¡ä»¶çš„æ ¼å¼æ›¸å¯«ï¼Œè«‹ç›´æ¥æä¾›å°è«‡æ©Ÿå™¨äººå¯ä»¥ç›´æ¥çµ¦å®¢æˆ¶çš„å›è¦†
                                ----------------------
"
                        },
                        new {
                             role = ChatGPT.role.user,
                              content = Message
                             },
                    }
                });
        }
    }
}
å¦‚æœå‡ºç¾ 307 error, è«‹åœ¨ç¨‹å¼ç¢¼ä¸­æ§“æ‰
//app.UseHttpsRedirection();

å¦‚æœ build error , è«‹åœ¨ç¨‹å¼ç¢¼ä¸­è£œä¸Š
using System.Net.Http;

Lab 5 : åŠ å…¥ä¼æ¥­è³‡æ–™(åŒ…å«èœå–®çš„é»é¤æ©Ÿå™¨äºº)
ä½¿ç”¨ä¸Šä¸€å€‹labåšå‡ºçš„ chat bot
ä¿®æ”¹prompt
ä½ æ˜¯é¤é£²åº—çš„å®¢æœæ©Ÿå™¨äººï¼Œæœƒå›ç­”å®¢æˆ¶è©¢å•çš„é¤é»å•é¡Œï¼Œä¸¦ä¸”æ¨è–¦è®“åº—è£¡ç²åˆ©æœ€é«˜çš„ç”¢å“ã€‚ä½ ä¹Ÿèƒ½è™•è£¡å®¢æˆ¶çš„æŠ±æ€¨å’Œç”³è¨´ï¼Œå®‰æ’«å®¢æˆ¶æƒ…ç·’ã€‚
ç›®å‰åº—è£¡é¢æ‰€è²©è³£çš„ç”¢å“æœ‰åº•ä¸‹é€™äº›:
å¤§äº¨å ¡ï¼Œ45å…ƒ
éº¥é¦™é›ï¼Œ36å…ƒ
è›‹é¤…ï¼Œ27å…ƒ
å¯éº—é¤…ï¼Œ50å…ƒ
é£¯ç³°ï¼Œ45å…ƒ
è€Œé£²æ–™æœ‰åº•ä¸‹é€™äº›:
å¯æ¨‚ï¼Œ55å…ƒ
ç´…èŒ¶ï¼Œ35å…ƒ
å¥¶èŒ¶ï¼Œ45å…ƒ
åº—è£¡æ²’æœ‰å¥—é¤ï¼Œåªèƒ½æŠŠé¤é»å’Œé£²æ–™æ­é…éŠ·å”®ï¼Œé€™æ¨£æ­é…æ²’æœ‰æŠ˜æ‰£ã€‚æ­¤å¤–ï¼Œè·Ÿå®¢äººæ¨è–¦é¤é»æ™‚ï¼Œå¿…é ˆæ˜¯ä¸Šè¿°çš„æ¸…å–®ä¸­çš„é¤é»ã€‚
ç›®å‰å”¯ä¸€çš„å„ªæƒ æ˜¯å‘¨æ—¥æ—©ä¸Šè²·ä¸€é€ä¸€ï¼Œåªé™å–®é»å¤§äº¨å ¡æ‰æœ‰é€™å€‹å„ªæƒ ã€‚
----------------------
åŠ å…¥history
user: è«‹å‘Šè¨´æˆ‘æœ€ä¾¿å®œçš„é¤é»åƒ¹æ ¼ã€‚
assistant: ä½ å¯ä»¥é»é¸è›‹é¤…ï¼Œåªéœ€è¦27å…ƒ
user: æœ‰ä»€éº¼å¥½åƒçš„é¤é»å—?
assistant: é€™å€‹å•é¡Œå¾ˆä¸»è§€ï¼Œä¸åŒçš„äººæœ‰ä¸åŒçš„å£å‘³å–œå¥½ï¼Œä»¥ä¸‹æ˜¯æˆ‘å€‹äººçš„æ¨è–¦:
1. å¤§äº¨å ¡ï¼šé€™æ˜¯æˆ‘å€‘é¤å»³çš„æ‹›ç‰Œé¤é»ï¼Œè‚‰è³ªé®®ç¾ï¼Œæ­é…ç‰¹è£½çš„é†¬æ–™éå¸¸ç¾å‘³
2. éº¥é¦™é›ï¼šé€™æ˜¯ä¸€å€‹å¾ˆå—æ­¡è¿çš„é¤é»ï¼Œé›è‚‰é®®å«©ï¼Œå¤–çš®é…¥è„†ï¼Œéå¸¸é©åˆç•¶ä½œåˆé¤æˆ–æ™šé¤ 
3. å¯éº—é¤…ï¼šé€™æ˜¯ä¸€å€‹å¾ˆå—æ­¡è¿çš„æ—©é¤é¤é»ï¼Œå£æ„Ÿè»Ÿå«©ï¼Œæ­é…æ¥“ç³–æ¼¿å’Œå¥¶æ²¹éå¸¸ç¾å‘³
user: æˆ‘æƒ³è¦åƒé£½ä¸€é»ï¼Œä½ å¯ä»¥æ¨è–¦æˆ‘è±ç››çš„å¥—é¤å—?
assistant: å¾ˆæŠ±æ­‰ï¼Œæˆ‘å€‘åº—è£¡æ²’æœ‰å¥—é¤ï¼Œåªèƒ½æŠŠé¤é»å’Œé£²æ–™æ­é…éŠ·å”®ã€‚
ä½†æ˜¯ï¼Œå¦‚æœä½ æƒ³åƒå¾—é£½ä¸€é»ï¼Œæˆ‘å»ºè­°ä½ å¯ä»¥è€ƒæ…®ä»¥ä¸‹æ­é…ï¼š
1. å¤§äº¨å ¡ + å¯æ¨‚ï¼šè‚‰è³ªé®®ç¾ï¼Œæ­é…å¯æ¨‚å£æ„Ÿæ›´ä½³ã€‚
2. éº¥é¦™é› + ç´…èŒ¶ï¼šé›è‚‰é®®å«©ï¼Œæ­é…ç´…èŒ¶å£æ„Ÿæ›´æ¸…çˆ½ã€‚
3. é£¯ç³° + å¥¶èŒ¶ï¼šé£¯ç³°ç‡Ÿé¤Šè±å¯Œï¼Œæ­é…å¥¶èŒ¶å£æ„Ÿæ›´é¦™æ¿ƒã€‚
å¸Œæœ›é€™äº›æ­é…å¯ä»¥æ»¿è¶³ä½ çš„é£Ÿæ…¾éœ€æ±‚ï¼
user: é€™äº›æ­é…å¥—é¤åˆ†åˆ¥æ˜¯å¤šå°‘éŒ¢?
assistant: å¾ˆæŠ±æ­‰ï¼Œæˆ‘å‰›æ‰çš„å›ç­”æœ‰é»ä¸æ¸…æ¥šï¼Œæˆ‘é‡æ–°æä¾›çµ¦ä½ æ›´è©³ç´°çš„åƒ¹æ ¼è³‡è¨Š:
1. å¤§äº¨å ¡ + å¯æ¨‚ = 100å…ƒ (å¤§äº¨å ¡ 45å…ƒ + å¯æ¨‚ 55å…ƒ)
2. éº¥é¦™é› + ç´…èŒ¶ = 71å…ƒ (éº¥é¦™é› 36å…ƒ + ç´…èŒ¶ 35å…ƒ)
3. é£¯ç³° + å¥¶èŒ¶ = 90å…ƒ (é£¯ç³° 45å…ƒ + å¥¶èŒ¶ 45å…ƒ)
å¸Œæœ›é€™äº›è³‡è¨Šå¯ä»¥å¹«åŠ©åˆ°ä½ ï¼
ref code:
https://gist.githubusercontent.com/isdaviddong/5c630c9a97720962fc52ef766dbb7530/raw/bae22e66b3b8a85ade70d9eba7be7f7488eab95c/LineBotChatGPTWebHookFor%25E6%2597%25A9%25E9%25A4%2590%25E5%25BA%2597Controller.cs

Lab 6 : ä½¿ç”¨ Azure OpenAI API å‘¼å«ChatGPTé€²è¡Œå°è«‡
POST /openai/deployments/gpt35/chat/completions?api-version=2023-03-15-preview HTTP/1.1
Host: testopenai202303.openai.azure.com
api-key: b60c24fad0f2c3c88bffe
Content-Type: application/json
Content-Length: 98

{
  "model": "gpt-3.5-turbo",
  "messages": [{"role": "user", "content": "DevOpså°è»Ÿé«”é–‹ç™¼å¾ˆé‡è¦å—?"}]
}
Lab 7: é»é¤æ©Ÿå™¨äºº
æ‰¿ä¸Šä¾‹ï¼Œä¿®æ”¹åŸæœ¬çš„line bot
åƒè€ƒåº•ä¸‹ç¨‹å¼ç¢¼å»ºç«‹é»é¤æ©Ÿå™¨äºº
https://gist.githubusercontent.com/isdaviddong/0226973d7170d87628909517b0bcb326/raw/993e1750e0f4b7ed4d444b902bac252ecf08be2b/SampleAzureOpenAILINEWebHook.cs
å˜—è©¦è©¢å•å„ªæƒ é¤é» <= æˆªåœ–
Lab 8: Azure OpenAI SDK
åƒè€ƒè³‡è¨Š :
endpoint: https://testopenai202303.openai.azure.com/
key: 52078a9a56e54931b182c259ef222381
deployment model: gpt35

æ­¥é©Ÿ:

æ–°å¢ dotnet core console app
dotnet new console -f net5.0
install .net core SDK
dotnet add package azure.ai.openai  --prerelease
æ’°å¯« console ç¨‹å¼ç¢¼ (streaming)
using System;
using System.Threading.Tasks;
using Azure;
using Azure.AI.OpenAI;

namespace testt
{
    class Program
    {
        static async Task Main(string[] args)
        {
            Console.OutputEncoding = System.Text.Encoding.UTF8;
            // See https://aka.ms/new-console-template for more information
            Console.WriteLine("Ready...");

            OpenAIClient client = new OpenAIClient(
                    new Uri("https://____Endpoint_____.openai.azure.com/"),
                    new Azure.AzureKeyCredential("______key______"));

            //string nonAzureOpenAIApiKey = "your-api-key-from-platform.openai.com";
            //var client = new OpenAIClient(nonAzureOpenAIApiKey, new OpenAIClientOptions());
            var chatCompletionsOptions = new ChatCompletionsOptions()
            {
                Messages =
    {
        new ChatMessage(ChatRole.System, "ä½ æ˜¯ä¸€å€‹æ™ºèƒ½åŠ©ç†ï¼Œä½ æœƒå›ç­”ä»»ä½•å•é¡Œï¼Œåƒæ˜¯ä¸€å€‹è°æ˜çš„æ™ºè€…ã€‚"),
        new ChatMessage(ChatRole.User, "ä½ èƒ½å¹«åŠ©æˆ‘å—?"),
        new ChatMessage(ChatRole.Assistant, "å¥½çš„ï¼Œæ²’æœ‰å•é¡Œã€‚æ‚¨è«‹ç™¼å•ï¼Œæˆ‘æœƒç›¡åŠ›å›ç­”~"),
        new ChatMessage(ChatRole.User, "æˆ‘è©²å¦‚ä½•æ‰ç²å¾—å¥½çš„æˆç¸¾å‘¢?"),
    }
            };

            Response<StreamingChatCompletions> response =
                await client.GetChatCompletionsStreamingAsync(
                deploymentOrModelName: "___deployment___", chatCompletionsOptions);
            using StreamingChatCompletions streamingChatCompletions = response.Value;

            await foreach (StreamingChatChoice choice in streamingChatCompletions.GetChoicesStreaming())
            {
                await foreach (ChatMessage message in choice.GetMessageStreaming())
                {
                    Console.Write(message.Content);
                }
                Console.WriteLine();
            }
        }
    }
}

æŠ“å–çµæœ
demo: èªéŸ³åŠ©ç†
https://github.com/isdaviddong/SpeechChatGPT.git

Lab 9 : å»ºç«‹LINE Botï¼ŒåŠ ä¸Šæ­·å²å°è«‡ç´€éŒ„
åƒè€ƒtokenè³‡è¨Š
endpoint : https://testopenai202303.openai.azure.com/
dployment name: gpt35
api-key: b878253b12344f709b8d26df1c36a092

æ­¥é©Ÿ:

ç”³è«‹ä¸¦å»ºç«‹LINE Bot
å–å¾— Channel access token
å»ºç«‹ .net core web api project
md testhistory
cd testhistory
dotnet new webapi
dotnet add package linebotsdk
dotnet new linewebhook
ä½¿ç”¨ LINE WebHook template
ä¸²æ¥ OpenAI API
æ¸¬è©¦
æ¸¬è©¦é€£çºŒå•é¡Œ:

ä½ å¥½ï¼Œæˆ‘å¯ä»¥å•å•é¡Œå—?
å°ç£æœ€å¤§çš„éƒ½å¸‚æ˜¯å“ªä¸€å€‹?
é€™å€‹åŸå¸‚æœ‰å¤šå°‘äººå£å‘¢?
æœ€å—ç«¯çš„åŸå¸‚æ˜¯å“ªä¸€å€‹å‘¢?
ç‹€æ³å¦‚ä½•? è«‹åˆ©ç”¨åº•ä¸‹ç¨‹å¼ç¢¼ä¿®æ”¹â€¦

sample code:
ä¸»ç¨‹å¼ç¢¼ç‰‡æ®µ
//å¦‚æœæ˜¯æ–‡å­—è¨Šæ¯
if (LineEvent.type.ToLower() == "message" && LineEvent.message.type == "text")
{
    if (LineEvent.message.text.Contains("/reset"))
    {
        ChatHistoryManager.DeleteIsolatedStorageFile();
        responseMsg = "æˆ‘å·²ç¶“æŠŠä¹‹å‰çš„å°è«‡éƒ½çµ¦å¿˜äº†!";
    }
    else
    {
        var chatHistory = ChatHistoryManager.GetMessagesFromIsolatedStorage(LineEvent.source.userId);
        responseMsg = ChatGPT.getResponseFromGPT(LineEvent.message.text, chatHistory);
        //å„²å­˜èŠå¤©ç´€éŒ„
        ChatHistoryManager.SaveMessageToIsolatedStorage(
            System.DateTime.Now, LineEvent.source.userId, LineEvent.message.text, responseMsg);
    }
}
else if (LineEvent.type.ToLower() == "message")
    responseMsg = $"æ”¶åˆ° event : {LineEvent.type} type: {LineEvent.message.type} ";
else
    responseMsg = $"æ”¶åˆ° event : {LineEvent.type} ";
//å›è¦†è¨Šæ¯

//æº–å‚™å›è¦†è¨Šæ¯
ChatGPT.cs
using System.Collections.Generic;
using System.Net.Http;
using System.Net.Http.Headers;
using System.Text;
using Newtonsoft.Json;

namespace isRock.Template
{
    [JsonConverter(typeof(Newtonsoft.Json.Converters.StringEnumConverter))]
    public enum Role
    {
        assistant, user, system
    }

    public class ChatGPT
    {
        const string AzureOpenAIEndpoint = "https://testopenai202303.openai.azure.com";  //ğŸ‘‰replace it with your Azure OpenAI Endpoint
        const string AzureOpenAIModelName = "gpt35"; //ğŸ‘‰repleace it with your Azure OpenAI Model Name
        const string AzureOpenAIToken = "b878253b12344f709b8d26df1c36a092"; //ğŸ‘‰repleace it with your Azure OpenAI Token
        const string AzureOpenAIVersion = "2023-03-15-preview";  //ğŸ‘‰replace  it with your Azure OpenAI Model Version

        public static string CallAzureOpenAIChatAPI(
            string endpoint, string modelName, string apiKey, string apiVersion, object requestData)
        {
            var client = new HttpClient();

            // è¨­å®š API ç¶²å€
            var apiUrl = $"{endpoint}/openai/deployments/{modelName}/chat/completions?api-version={apiVersion}";

            // è¨­å®š HTTP request headers
            client.DefaultRequestHeaders.Add("api-key", apiKey);
            client.DefaultRequestHeaders.Accept.Add(new MediaTypeWithQualityHeaderValue("application/json"));//ACCEPT heade
            // å°‡ requestData ç‰©ä»¶åºåˆ—åŒ–æˆ JSON å­—ä¸²
            string jsonRequestData = Newtonsoft.Json.JsonConvert.SerializeObject(requestData);
            // å»ºç«‹ HTTP request å…§å®¹
            var content = new StringContent(jsonRequestData, Encoding.UTF8, "application/json");
            // å‚³é€ HTTP POST request
            var response = client.PostAsync(apiUrl, content).Result;
            // å–å¾— HTTP response å…§å®¹
            var responseContent = response.Content.ReadAsStringAsync().Result;
            var obj = Newtonsoft.Json.JsonConvert.DeserializeObject<dynamic>(responseContent);
            return obj.choices[0].message.content.Value;
        }


        public static string getResponseFromGPT(string Message, List<Message> chatHistory)
        {
            //å»ºç«‹å°è©±ç´€éŒ„
            var messages = new List<ChatMessage>
                    {
                        new ChatMessage {
                            role = Role.system ,
                            content = @"
                                å‡è¨­ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„å°éŠäººå“¡ï¼Œå°æ–¼å®¢æˆ¶éå¸¸æœ‰ç¦®è²Œã€ä¹Ÿèƒ½å¤ å®‰æ’«å®¢æˆ¶çš„æŠ±æ€¨æƒ…ç·’ã€‚
                                è«‹æª¢è¦–åº•ä¸‹çš„å®¢æˆ¶è¨Šæ¯ï¼Œä»¥æœ€è¦ªåˆ‡æœ‰ç¦®çš„æ–¹å¼å›æ‡‰ã€‚

                                ä½†å›æ‡‰æ™‚ï¼Œè«‹æ³¨æ„ä»¥ä¸‹å¹¾é»:
                                * ä¸è¦èªª 'æ„Ÿè¬ä½ çš„ä¾†ä¿¡' ä¹‹é¡çš„è©±ï¼Œå› ç‚ºå®¢æˆ¶æ˜¯å¾å°è«‡è¦–çª—è¼¸å…¥è¨Šæ¯çš„ï¼Œä¸æ˜¯å¯«ä¿¡ä¾†çš„
                                * ä¸èƒ½éåº¦æ‰¿è«¾
                                * è¦åŒç†å®¢æˆ¶çš„æƒ…ç·’
                                * è¦èƒ½å¤ ç›¡é‡è§£æ±ºå®¢æˆ¶çš„å•é¡Œ
                                * ä¸è¦ä»¥å›è¦†ä¿¡ä»¶çš„æ ¼å¼æ›¸å¯«ï¼Œè«‹ç›´æ¥æä¾›å°è«‡æ©Ÿå™¨äººå¯ä»¥ç›´æ¥çµ¦å®¢æˆ¶çš„å›è¦†
                                ----------------------
"
                        }
                    };

            //æ·»åŠ æ­·å²å°è©±ç´€éŒ„
            foreach (var HistoryMessageItem in chatHistory)
            {
                //æ·»åŠ ä¸€çµ„å°è©±ç´€éŒ„
                messages.Add(new ChatMessage()
                {
                    role = Role.user,
                    content = HistoryMessageItem.UserMessage
                });
                messages.Add(new ChatMessage()
                {
                    role = Role.assistant,
                    content = HistoryMessageItem.ResponseMessage
                });
            }
            messages.Add(new ChatMessage()
            {
                role = Role.user,
                content = Message
            });
            //å›å‚³å‘¼å«çµæœ
            return ChatGPT.CallAzureOpenAIChatAPI(
               AzureOpenAIEndpoint, AzureOpenAIModelName, AzureOpenAIToken, AzureOpenAIVersion,
                new
                {
                    model = "gpt-3.5-turbo",
                    messages = messages
                }
             );
        }
    }

    public class ChatMessage
    {
        public Role role { get; set; }
        public string content { get; set; }
    }

}
ChatHistoryManager.cs
 using isRock.LineBot;
using System;
using System.Collections.Generic;
using System.IO;
using System.IO.IsolatedStorage;
using System.Linq;

namespace isRock.Template
{
    //ä¸€çµ„å°è«‡è¨Šæ¯
    public class Message
    {
        public DateTime Time { get; set; }
        public string UserID { get; set; }
        public string UserMessage { get; set; }
        public string ResponseMessage { get; set; }
    }

    //å°è©±ç´€éŒ„è™•ç†
    public class ChatHistoryManager
    {
        const string fileName = "messages.json"; //å„²å­˜åˆ° IsolatedStorage çš„æª”æ¡ˆåç¨±

        /// <summary>
        /// å°‡æ‰€æœ‰å°è©±ç´€éŒ„åˆªé™¤
        /// </summary>
        public static void DeleteIsolatedStorageFile()
        {
            using (var isolatedStorage = IsolatedStorageFile.GetUserStoreForAssembly())
            {
                if (isolatedStorage.FileExists(fileName))
                {
                    isolatedStorage.DeleteFile(fileName);
                }
            }
        }

        /// <summary>
        /// å–å¾—å°è«‡ç´€éŒ„(ä¾ç…§ UserID)
        /// </summary>
        /// <param name="UserID"></param>
        /// <returns></returns>
        public static List<Message> GetMessagesFromIsolatedStorage(string UserID)
        {
            var messages = new List<Message>();
            using (var isolatedStorage = IsolatedStorageFile.GetUserStoreForAssembly())
            {
                if (isolatedStorage.FileExists(fileName))
                {
                    using (var fileStream = new IsolatedStorageFileStream(fileName, FileMode.Open, isolatedStorage))
                    {
                        using (var reader = new StreamReader(fileStream))
                        {
                            string line;
                            while ((line = reader.ReadLine()) != null)
                            {
                                var message = Newtonsoft.Json.JsonConvert.DeserializeObject<Message>(line);
                                messages.Add(message);
                            }
                        }
                    }
                }
            }

            return messages.Where(c => c.UserID == UserID).OrderBy(c => c.Time).ToList();
        }

        /// <summary>
        /// å„²å­˜å°è«‡ç´€éŒ„åˆ°IsolatedStorage
        /// </summary>
        /// <param name="time"></param>
        /// <param name="userID"></param>
        /// <param name="userMessage"></param>
        /// <param name="responseMessage"></param>
        public static void SaveMessageToIsolatedStorage(
            DateTime time, string userID, string userMessage, string responseMessage)
        {
            // å»ºç«‹ JSON ç‰©ä»¶
            var messageObject = new
            {
                Time = time,
                UserID = userID,
                UserMessage = userMessage,
                ResponseMessage = responseMessage
            };
            var json = Newtonsoft.Json.JsonConvert.SerializeObject(messageObject);

            // è®€å– Isolated Storage ä¸­çš„è³‡æ–™
            List<string> messages = new List<string>();
            var fileName = "messages.json";

            using (var isolatedStorage = IsolatedStorageFile.GetUserStoreForAssembly())
            {
                if (isolatedStorage.FileExists(fileName))
                {
                    using (var fileStream = new IsolatedStorageFileStream(fileName, FileMode.Open, isolatedStorage))
                    {
                        using (var reader = new StreamReader(fileStream))
                        {
                            string line;
                            while ((line = reader.ReadLine()) != null)
                            {
                                messages.Add(line);
                            }
                        }
                    }
                }
            }

            // åŠ ä¸Šæ–°çš„ JSON ç‰©ä»¶
            messages.Add(json);

            // å¯«å› Isolated Storage ä¸­
            using (var isolatedStorage = IsolatedStorageFile.GetUserStoreForAssembly())
            {
                using (var fileStream = new IsolatedStorageFileStream(fileName, FileMode.Create, isolatedStorage))
                {
                    using (var writer = new StreamWriter(fileStream))
                    {
                        foreach (var message in messages)
                        {
                            writer.WriteLine(message);
                        }
                    }
                }
            }
        }
    }
}
å®Œæˆå…·æœ‰æ­·å²å°è«‡è¨Šæ¯çš„chatbot <==æˆªåœ–


final version:
https://github.com/isdaviddong/ChatGPTLineBotWithChatHistory_net5.git

ä½¿ç”¨ Language Understanding
Lab 10: å»ºç«‹Text Analysiså¸³è™Ÿèˆ‡æœå‹™ï¼Œå»ºç«‹å¯å€åˆ†è¨‚é¤ vs å®¢è¨´çš„LU App
åœ¨Azure Portalå»ºç«‹ Text Analytics æœå‹™
å¯é¸æ“‡S1 pricing tier
å»ºè­°å»ºç«‹æ–°çš„resource group
å®Œæˆå¾Œï¼Œé€²å…¥ https://language.cognitive.azure.com/clu/ , ä»¥ç›¸åŒçš„MSAç™»å…¥
å»ºç«‹+New App (åç¨±å¯ç”¨ test[YourName)]
å»ºç«‹ intent [é»é¤è¡Œç‚º]
å»ºç«‹ [é£²æ–™åç¨±]ã€[é¤é»åç¨±]ç­‰entities
å¡«å…¥[é»é¤è¡Œç‚º]ä¾‹å¥
ex.

é»é¤èªæ–™å€
æˆ‘è¦é»ä¸€ä»½ç‡’é¤…æ²¹æ¢
éº»ç…©ä½ æˆ‘éœ€è¦ä¸€ä»½è›‹é¤…
çµ¦æˆ‘ä¾†å€‹å¤§äº¨å ¡
ä¸‰æ˜æ²»å¸¶èµ°
ä»Šå¤©è«‹å¹«æˆ‘ä¾†ä¸€å€‹é£¯ç³°
ä»Šå¤©æˆ‘æƒ³è¦ä¸€ä»½å’”å•¦é›è…¿å ¡å’Œå¯æ¨‚ä¸€æ¯
ä¾†ä¸€ä»½ç‚’æ³¡éºµåŠ è›‹ä¸è¦è¾£
æ’éª¨é£¯åŠ ç«¹ç­æ¹¯ä¸€ä»½å¸¶èµ°
çµ¦æˆ‘ä¾†ä¸€ä»½é»ƒé‡‘é–‹å£ç¬‘
æˆ‘è¦ä¸€æ¯å¤§çå¥¶å¾®ç³–
ä»Šæ™šï¼Œæˆ‘æƒ³ä¾†é»â€¦é‡‘é‹’çš„æ»·è‚‰é£¯åŠ è›‹ã€‚
ä¾†ä¸€ä»½5è™Ÿé™å®šé¦™è•‰
ä¾†ä¸€ç¢—è²¢ä¸¸æ¹¯åŠ å¤§ä¸è¦è²¢ä¸¸
çµ¦ç´å¦ä¾†ä¸€ä»½éŠ…é‘¼ç‡’æ—©é¤ï¼Œæˆ‘è¦ç¶“å…¸ç´ç´„å®¢æ—©åˆé¤
æˆ‘æƒ³åƒç±³ç³•ä¾¿ç•¶
è€é—†çµ¦æˆ‘ä¾†å€‹ä»Šæ—¥ç‰¹é¤
çµ¦é–‹å¸ä¸€ç½å•¤é…’

Step 2: å»ºç«‹å¯å€åˆ†è¨‚é¤ vs å®¢è¨´çš„LU App
æ­¥é©Ÿ:

å»ºç«‹intent [å®¢è¨´]
å¡«å…¥[å®¢è¨´]ä¾‹å¥ã€è¨“ç·´
å®¢è¨´èªæ–™å€
å«ä½ è€é—†å‡ºä¾†
æˆ‘ä¸å–œæ­¡ä½ å€‘å¯æ¨‚çš„å‘³é“
åº—å“¡æœå‹™æ…‹åº¦ä¸å¥½
è€é—†æˆ‘è¦çš„ç‚’éºµä¸è¦åŠ è¾£ï¼Œç²¥ä¸è¦è”¥å•¦
æ¹¯è£¡æœ‰å°å¼·
ä»Šå¤©è‚‰æ²’ç†Ÿï¼Œæ¹¯å¾ˆé…¸
æœå‹™æœ‰å¤ å·®ï¼Œè€æ¿è‡‰çœŸè‡­
åœ°å¾ˆé«’
ç©ºèª¿æ˜¯æœ‰æ²’æœ‰é–‹æ‹‰
æ¼¢å ¡å¾ˆé›£åƒ
ç‰›æ’è£¡é¢æœ‰é ­é«®
åœ°æ¿é»é»æ¿•æ¿•çš„

ç™¼ä½ˆmodel
é€éendpointç¢ºèªmodelæ˜¯å¦å¯é †åˆ©è¾¨è­˜[å®¢è¨´]æˆ–[é»é¤]
è¨“ç·´ä¸¦ç™¼ä½ˆç‚ºæœå‹™ï¼Œä¸¦ä½¿ç”¨postmanæ¸¬è©¦ <== æˆªåœ–
POST /language/:analyze-conversations?api-version=2022-10-01-preview HTTP/1.1
Host: ___________.cognitiveservices.azure.com
Ocp-Apim-Subscription-Key: ______________
Content-Type: application/json
Content-Length: 433

{
    "kind": "Conversation",
    "analysisInput": {
        "conversationItem": {
            "id": "1",
            "text": "å†°å¥¶èŒ¶æ˜¯å¥½å–çš„",
            "modality": "text",
            "language": "zh-tw",
            "participantId": "1"
        }
    },
    "parameters": {
        "projectName": "testdavid",
        "verbose": true,
        "deploymentName": "S1",
        "stringIndexType": "TextElement_V8"
    }
}
response

{
    "kind": "Conversation",
    "analysisInput": {
        "conversationItem": {
            "id": "1",
            "text": "å†°å¥¶èŒ¶æ˜¯å¥½å–çš„",
            "modality": "text",
            "language": "zh-tw",
            "participantId": "1"
        }
    },
    "parameters": {
        "projectName": "testdavid",
        "verbose": true,
        "deploymentName": "S1",
        "stringIndexType": "TextElement_V8"
    }
}


Lab 11 : ä½¿ç”¨AOAI, å»ºç«‹å¯ä»¥ç”¢å‡ºè³¼ç¥¨ intent, entity çš„ prompt
ç•¶ç”¨æˆ¶èªª: æˆ‘è¦2å¼µå¾å°åŒ—åˆ°æ–°ç«¹çš„è‡ªç”±åº§ï¼Œå¦å¤–é‚„è¦è²·ä¸€æ¯å’–å•¡
OpenAI APIå°‡æœƒåˆ¤æ–· intent èˆ‡ entities, æœ€çµ‚éœ€è¦è¼¸å‡ºçš„çµæœå¦‚ä¸‹ï¼Œ

{
  "intent": "è³¼ç¥¨",
  "entities": {
    "èµ·ç«™": "å°åŒ—",
    "è¿„ç«™": "æ–°ç«¹",
    "è»Šç¥¨ç¥¨ç¨®": "è‡ªç”±åº§",
    "æ•¸é‡": "2"
  },
  "text": "æˆ‘è¦2å¼µå¾å°åŒ—åˆ°æ–°ç«¹çš„è‡ªç”±åº§ï¼Œå¦å¤–é‚„è¦è²·ä¸€æ¯å’–å•¡"
}
sample system prompt:

ä½ æ˜¯ä¸€å€‹èƒ½å¤ åˆ¤æ–· Intent ä¸¦ä¸”æ“·å– Entities çš„AIï¼Œ
æœƒè®€å–ç”¨æˆ¶å‚³å…¥çš„æ–‡å­—æ•˜è¿°ï¼Œåˆ¤æ–·å‡ºè©²æ•˜è¿°çš„æ„åœ–(Intent)ï¼Œä¸¦ä¸”æŠ“å–æ–‡å­—æ•˜è¿°ä¸­é—œéµçš„entitiesã€‚
æ„åœ–åªæœ‰ è³¼ç¥¨/å®¢è¨´/é–’èŠ ä¸‰ç¨®ï¼Œè«‹åˆ¤æ–·å‡ºæœ€æ¥è¿‘çš„æ„åœ–ï¼Œä¸¦å°‡çµæœä»¥JSONå›å‚³ï¼Œå±¬æ€§åç¨±ç‚º intentã€‚
entities åˆ†åˆ¥æœ‰ èµ·ç«™(start)/è¿„ç«™(arrive)/æ™‚é–“(date)/è»Šç¥¨ç¥¨ç¨®(type)/æ•¸é‡(amount)ï¼Œè«‹åˆ¤æ–·å‡ºæ–‡å­—æ•˜è¿°ä¸­çš„entitiesï¼Œä¸¦å°‡çµæœä»¥JSONå›å‚³ï¼Œå±¬æ€§åç¨±ç‚ºentitiesã€‚

è«‹ç›´æ¥çµ„ä¸€å€‹JSONçµ¦æˆ‘ï¼Œä¸éœ€è¦ä»»ä½•æ–‡å­—è§£é‡‹ï¼Œåªè¦å›å‚³JSONå³å¯ 
åŒæ™‚è«‹æ³¨æ„ä»¥ä¸‹è¦å‰‡:
* JSONä¸­çš„ entities å±¬æ€§æ˜¯é™£åˆ—æ ¼å¼ï¼Œå¦‚æœç™¼ç¾æœ‰å¤šç¨®entitiesï¼Œè«‹åœ¨JSONä¸­ä»¥é™£åˆ—æ–¹å¼å›å‚³ï¼Œå±¬æ€§åç¨±ç‚º entities 
* JSONä¸­çš„ intent å±¬æ€§çš„å€¼ï¼Œåªèƒ½æ˜¯ è³¼ç¥¨/å®¢è¨´/é–’èŠ ä¸‰ç¨®ä¹‹ä¸€ 
* åŸå§‹èªå¥ç”¨ text å±¬æ€§å›å‚³ 
* ä¸éœ€è¦ä»»ä½•æ–‡å­—è§£é‡‹ï¼Œåªè¦å›å‚³JSONå³å¯ 
--- 
ref: https://gist.githubusercontent.com/isdaviddong/a896084082664958c28ac30b71c66b08/raw/7a9836601bbdbb4f22a2109ecb125ec01b1b8ac9/prompt.txt

Lab 12: å»ºç«‹è³¼ç¥¨æ©Ÿå™¨äºº
æ‰¿ä¸Šé¡Œ
å»ºç«‹ä¸€å€‹ LINE Bot å°è«‡æ©Ÿå™¨äºº
md folder
cd folder
dotnet new webapi
dotnet add package linebotsdk
dotnet new linewebhook
dotnet build
code .
ä½¿ç”¨ä½ å‰›æ‰å»ºç«‹å‡ºçš„ prompt
public static string getResponseFromGPT(string Message)
{
    return ChatGPT.CallAzureOpenAIChatAPI(
       AzureOpenAIEndpoint, AzureOpenAIModelName, AzureOpenAIToken, AzureOpenAIVersion,
        //ref: https://learn.microsoft.com/en-us/azure/cognitive-services/openai/reference#chat-completions
        new
        {
            model = "gpt-3.5-turbo",
            messages = new[]
            {
                new {
                    role = ChatGPT.role.system ,
                    content = @"
                        ä½ æ˜¯ä¸€å€‹èƒ½å¤ åˆ¤æ–· Intent ä¸¦ä¸”æ“·å– Entities çš„AIï¼Œ
                        æœƒè®€å–ç”¨æˆ¶å‚³å…¥çš„æ–‡å­—æ•˜è¿°ï¼Œåˆ¤æ–·å‡ºè©²æ•˜è¿°çš„æ„åœ–(Intent)ï¼Œä¸¦ä¸”æŠ“å–æ–‡å­—æ•˜è¿°ä¸­é—œéµçš„entitiesã€‚
                        æ„åœ–åªæœ‰ è³¼ç¥¨/å®¢è¨´/é–’èŠ ä¸‰ç¨®ï¼Œè«‹åˆ¤æ–·å‡ºæœ€æ¥è¿‘çš„æ„åœ–ï¼Œä¸¦å°‡çµæœä»¥JSONå›å‚³ï¼Œå±¬æ€§åç¨±ç‚º intentã€‚
                        entities åˆ†åˆ¥æœ‰ èµ·ç«™(start)/è¿„ç«™(arrive)/æ™‚é–“(date)/è»Šç¥¨ç¥¨ç¨®(type)/æ•¸é‡(amount)ï¼Œè«‹åˆ¤æ–·å‡ºæ–‡å­—æ•˜è¿°ä¸­çš„entitiesï¼Œä¸¦å°‡çµæœä»¥JSONå›å‚³ï¼Œå±¬æ€§åç¨±ç‚ºentitiesã€‚

                        è«‹ç›´æ¥çµ„ä¸€å€‹JSONçµ¦æˆ‘ï¼Œä¸éœ€è¦ä»»ä½•æ–‡å­—è§£é‡‹ï¼Œåªè¦å›å‚³JSONå³å¯ 
                        åŒæ™‚è«‹æ³¨æ„ä»¥ä¸‹è¦å‰‡:
                        * JSONä¸­çš„ entities å±¬æ€§æ˜¯é™£åˆ—æ ¼å¼ï¼Œå¦‚æœç™¼ç¾æœ‰å¤šç¨®entitiesï¼Œè«‹åœ¨JSONä¸­ä»¥é™£åˆ—æ–¹å¼å›å‚³ï¼Œå±¬æ€§åç¨±ç‚º entities 
                        * JSONä¸­çš„ intent å±¬æ€§çš„å€¼ï¼Œåªèƒ½æ˜¯ è³¼ç¥¨/å®¢è¨´/é–’èŠ ä¸‰ç¨®ä¹‹ä¸€ 
                        * åŸå§‹èªå¥ç”¨ text å±¬æ€§å›å‚³ 
                        * ä¸éœ€è¦ä»»ä½•æ–‡å­—è§£é‡‹ï¼Œåªè¦å›å‚³JSONå³å¯ 
                        ----------------------
                        "
                },
                new {
                     role = ChatGPT.role.user,
                     content = Message
                },
            }
        });
}
å¯ä»¥æ¥æ”¶ç”¨æˆ¶çš„è³¼ç¥¨è¦æ±‚ï¼Œå‰–æç”¨æˆ¶æ„åœ–
æœ€çµ‚ç”¢ç”Ÿä¸€çµ„JSONç›´æ¥å›æ‡‰çµ¦ç”¨æˆ¶å³å¯ <== æˆªåœ–

Lab 13 : è³¼ç¥¨æ©Ÿå™¨äºº - better version
åƒè€ƒåº•ä¸‹å½±ç‰‡ï¼Œå»ºç«‹ä¸€å€‹çœŸæ­£å¯ä»¥äº’å‹•çš„è³¼ç¥¨(æˆ–è«‹å‡)æ©Ÿå™¨äºº

åƒè€ƒ prompt:

ä½ æ˜¯ä¸€å€‹å”®ç¥¨å®¢æœæ©Ÿå™¨äººï¼Œå®¢æˆ¶æœƒå‘ä½ è³¼ç¥¨ï¼Œä½ å¿…é ˆå¾å®¢æˆ¶çš„è³¼ç¥¨æ•˜è¿°ä¸­æ‰¾åˆ°åº•ä¸‹é€™äº›è³¼ç¥¨è³‡è¨Šã€‚
æ‰¾åˆ°çš„è³‡è¨Šå¿…é ˆè¦†è¿°ä¸€æ¬¡ï¼Œå¦‚æœæœ‰ç¼ºå°‘çš„è³‡è¨Šï¼Œå¿…é ˆæé†’å®¢æˆ¶ç¼ºå°‘çš„éƒ¨åˆ†ï¼Œç›´åˆ°è’é›†å®Œæ‰€æœ‰è³‡è¨Šå¾Œï¼Œ
è¦è·Ÿå®¢æˆ¶åšæœ€å¾Œçš„ç¢ºèªï¼Œä¸¦ä¸”å•å®¢æˆ¶æ˜¯å¦æ­£ç¢º? 

å¦‚æœå®¢æˆ¶å›ç­”ä¸æ­£ç¢ºï¼Œå‰‡è¦é‡æ–°è’é›†è³‡è¨Šã€‚
å¦‚æœå®¢æˆ¶èªªæ­£ç¢ºï¼Œå‰‡å°‡è’é›†åˆ°çš„è³‡æ–™ï¼Œæ•´ç†æˆä¸€å€‹JSONå­—ä¸²ï¼Œç›´æ¥è¼¸å‡ºï¼Œç„¡é ˆå›è¦†å…¶ä»–æ–‡å­—ã€‚ã€‚

è³¼ç¥¨è³‡è¨ŠåŒ…å«:
* ä¹˜è»Šèµ·å§‹ç«™
* ä¹˜è»Šç›®çš„ç«™     
* ä¹˜è»Šé è¨ˆå‡ºç™¼æ™‚é–“
* ä¹˜è»Šå¼µæ•¸
* ä¹˜è»Šç¥¨ç¨®

ç¥¨ç¨®åŒ…å«:
* å…¨ç¥¨
* å­¸ç”Ÿç¥¨
* æ„›å¿ƒç¥¨
* è‡ªç”±åº§

å›æ‡‰æ™‚ï¼Œè«‹æ³¨æ„ä»¥ä¸‹å¹¾é»:
* ä¸è¦èªª 'æ„Ÿè¬ä½ çš„ä¾†ä¿¡' ä¹‹é¡çš„è©±ï¼Œå› ç‚ºå®¢æˆ¶æ˜¯å¾å°è«‡è¦–çª—è¼¸å…¥è¨Šæ¯çš„ï¼Œä¸æ˜¯å¯«ä¿¡ä¾†çš„
* ä¸è¦ä¸€ç›´èªªæŠ±æ­‰æˆ–å°ä¸èµ·ï¼Œä½†å¯ä»¥èªªä¸å¥½æ„æ€ã€‚
* ä¸è¦å¹«å®¢æˆ¶è³¼ç¥¨ï¼Œä¹Ÿä¸è¦èªªè·Ÿé‡‘é¡æœ‰é—œçš„äº‹æƒ…
* è¦èƒ½å¤ ç›¡é‡è§£æ±ºå®¢æˆ¶çš„å•é¡Œ
* ä¸è¦ä»¥å›è¦†ä¿¡ä»¶çš„æ ¼å¼æ›¸å¯«ï¼Œè«‹ç›´æ¥æä¾›å°è«‡æ©Ÿå™¨äººå¯ä»¥ç›´æ¥çµ¦å®¢æˆ¶çš„å›è¦†
----------------------
å•å·ä½ç½®
https://survey.uuu.com.tw/
22306201


è¬›å¸«ä»‹ç´¹

https://www.studyhost.tw/NewCourses/è¬›å¸«ç°¡ä»‹-David